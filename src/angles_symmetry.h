/*
 * This file is part of the Substack Analysis (SUSAN) framework.
 * Copyright (c) 2018-2021 Ricardo Miguel Sanchez Loayza.
 * Max Planck Institute of Biophysics
 * Department of Structural Biology - Kudryashev Group.
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 * 
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

#ifndef ANGLES_SYMMETRY_H
#define ANGLES_SYMMETRY_H

#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <cstdint>
#include <cmath>

#include "datatypes.h"
#include "math_cpu.h"

//using namespace Eigen;
using namespace Math;

class AnglesSymmetry {

public:
    static bool check_available_symmetry(const char*sym_str) {
        bool rslt = false;

        rslt |= (strcmp(sym_str,"cone_flip") == 0);
        rslt |= (strcmp(sym_str,"y_180") == 0);
        rslt |= (strcmp(sym_str,"cbo") == 0);
        rslt |= (strcmp(sym_str,"CBO") == 0);
        rslt |= (strcmp(sym_str,"ico") == 0);
        rslt |= (strcmp(sym_str,"ICO") == 0);
        rslt |= (strcmp(sym_str,"c1") == 0);
        rslt |= (strcmp(sym_str,"none") == 0);
        rslt |= ( (sym_str[0] == 'd') && (atoi(sym_str+1)>0) );
        rslt |= ( (sym_str[0] == 'D') && (atoi(sym_str+1)>0) );
        rslt |= ( (sym_str[0] == 'c') && (atoi(sym_str+1)>0) );
        rslt |= ( (sym_str[0] == 'C') && (atoi(sym_str+1)>0) );
        rslt |= ( (sym_str[0] == 'h') && (sym_str[1] == 'p') && (atoi(sym_str+2)>0) );
        rslt |= ( (sym_str[0] == 'H') && (sym_str[1] == 'P') && (atoi(sym_str+2)>0) );

        return rslt;
    }

    static M33f*get_rotation_list(uint32 &N, const char*sym_str) {
        N = 0;
        if( (strcmp(sym_str,"cone_flip") == 0) || (strcmp(sym_str,"y_180") == 0) ) {
            N = 2;
            return cone_flip();
        }
        else if( (strcmp(sym_str,"cbo") == 0) || (strcmp(sym_str,"CBO") == 0) ) {
            N = 24;
            return cuboctahedral();
        }
        else if( (strcmp(sym_str,"ico") == 0) || (strcmp(sym_str,"ICO") == 0) ) {
            N = 60;
            return icosahedral();
        }
        else if( (strcmp(sym_str,"c1") == 0) || (strcmp(sym_str,"none") == 0) ) {
            N = 1;
            return none();
        }
        else if( (sym_str[0] == 'c') || (sym_str[0] == 'C') ) {
            N = atoi(sym_str+1);
            return Cn(N);
        }
        else if( (sym_str[0] == 'd') || (sym_str[0] == 'D') ) {
            N = atoi(sym_str+1);
            return Dn(N);
        }
        else if( (sym_str[0] == 'h') && (sym_str[1] == 'p') || (sym_str[0] == 'H') && (sym_str[1] == 'P') ) {
            N = atoi(sym_str+2);
            return HealPix(N);
        }
        else {
            return NULL;
        }
    }

protected:
    static void populate_rotation_array(M33f*rslt,const float*eu0,const float*eu1,const float*eu2,const int N) {
        V3f eu;
        for(int n=0;n<N;n++) {
            eu << eu0[n], eu1[n], eu2[n];
            Math::eZYZ_Rmat(rslt[n],eu);
        }
    }

    static M33f*none() {
        M33f*rslt = new M33f[1];
        V3f eu;
        eu(0) = 0;
        eu(1) = 0;
        eu(2) = 0;
        Math::eZYZ_Rmat(rslt[0],eu);
        return rslt;
    }

    static M33f*y_180() {
        M33f*rslt = new M33f[2];
        V3f eu;
        eu(0) = 0;
        eu(1) = 0;
        eu(2) = 0;
        Math::eZYZ_Rmat(rslt[0],eu);
        eu(1) = M_PI;
        Math::eZYZ_Rmat(rslt[1],eu);
        return rslt;
    }

    static M33f*cone_flip() {
        return y_180();
    }

    static M33f*Cn(int N) {
        if( N > 0 ) {
            M33f*rslt = new M33f[N];
            V3f eu;
            eu(0) = 0;
            eu(1) = 0;
            eu(2) = 0;
            for(int n=0;n<N;n++) {
                float angle = 2*M_PI*float(n)/float(N);
                eu(0) = angle;
                Math::eZYZ_Rmat(rslt[n],eu);
            }
            return rslt;
        }
        else
            return NULL;
    }

    static M33f*D2(uint32&N) {
        M33f*rslt = new M33f[4];
        float eu0[4] = { 0.000000, 3.141593,-3.141593,-0.000000};
        float eu1[4] = { 0.000000, 0.000000, 3.141593, 3.141593};
        float eu2[4] = { 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,4);
        N = 4;
        return rslt;
    }

    static M33f*D3(uint32&N) {
        M33f*rslt = new M33f[6];
        float eu0[6] = { 0.000000, 2.094395,-2.094395,-3.141593,-1.047198, 1.047198};
        float eu1[6] = { 0.000000, 0.000000, 0.000000, 3.141593, 3.141593, 3.141593};
        float eu2[6] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,6);
        N = 6;
        return rslt;
    }

    static M33f*D4(uint32&N) {
        M33f*rslt = new M33f[8];
        float eu0[8] = { 0.000000, 1.570796, 3.141593,-1.570796,-3.141593,-1.570796,-0.000000, 1.570796};
        float eu1[8] = { 0.000000, 0.000000, 0.000000, 0.000000, 3.141593, 3.141593, 3.141593, 3.141593};
        float eu2[8] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,8);
        N = 8;
        return rslt;
    }

    static M33f*D5(uint32&N) {
        M33f*rslt = new M33f[10];
        float eu0[10] = { 0.000000, 1.256637, 2.513274,-2.513274,-1.256637,-3.141593,-1.884956,-0.628319, 0.628319, 1.884956};
        float eu1[10] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 3.141593, 3.141593, 3.141593, 3.141593, 3.141593};
        float eu2[10] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,10);
        N = 10;
        return rslt;
    }

    static M33f*D6(uint32&N) {
        M33f*rslt = new M33f[12];
        float eu0[12] = { 0.000000, 1.047198, 2.094395, 3.141593,-2.094395,-1.047198,-3.141593,-2.094395,-1.047198,-0.000000, 1.047198, 2.094395};
        float eu1[12] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 3.141593, 3.141593, 3.141593, 3.141593, 3.141593, 3.141593};
        float eu2[12] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,12);
        N = 12;
        return rslt;
    }

    static M33f*D7(uint32&N) {
        M33f*rslt = new M33f[14];
        float eu0[14] = { 0.000000, 0.897598, 1.795196, 2.692794,-2.692794,-1.795196,-0.897598,-3.141593,-2.243995,-1.346397,-0.448799, 0.448799, 1.346397, 2.243995};
        float eu1[14] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 3.141593, 3.141593, 3.141593, 3.141593, 3.141593, 3.141593, 3.141593};
        float eu2[14] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,14);
        N = 14;
        return rslt;
    }

    static M33f*D8(uint32&N) {
        M33f*rslt = new M33f[16];
        float eu0[16] = { 0.000000, 0.785398, 1.570796, 2.356194, 3.141593,-2.356194,-1.570796,-0.785398,-3.141593,-2.356194,-1.570796,-0.785398,-0.000000, 0.785398, 1.570796, 2.356194};
        float eu1[16] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 3.141593, 3.141593, 3.141593, 3.141593, 3.141593, 3.141593, 3.141593, 3.141593};
        float eu2[16] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,16);
        N = 16;
        return rslt;
    }

    static M33f*Dn(uint32&N) {
        if( N == 2 ){
            return D2(N);
        }
        else if( N == 3 ){
            return D3(N);
        }
        else if( N == 4 ){
            return D4(N);
        }
        else if( N == 5 ){
            return D5(N);
        }
        else if( N == 6 ){
            return D6(N);
        }
        else if( N == 7 ){
            return D7(N);
        }
        else if( N == 8 ){
            return D8(N);
        }
        else
            return NULL;
    }

    static M33f*HealPix1(uint32&N) {
        /// Estimated angular resolution: 58.632301428350395
        N = 12;
        M33f*rslt = new M33f[12];
        float eu0[12] = { 0.785398, 2.356194, 3.926991, 5.497787, 0.000000, 1.570796, 3.141593, 4.712389, 0.785398, 2.356194, 3.926991, 5.497787};
        float eu1[12] = { 0.841069, 0.841069, 0.841069, 0.841069, 1.570796, 1.570796, 1.570796, 1.570796, 2.300524, 2.300524, 2.300524, 2.300524};
        float eu2[12] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,12);
        return rslt;
    }

    static M33f*HealPix2(uint32&N) {
        /// Estimated angular resolution: 29.316150714175198
        N = 48;
        M33f*rslt = new M33f[48];
        float eu0[48] = { 0.785398, 2.356194, 3.926991, 5.497787, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.000000, 0.785398, 1.570796, 2.356194, 3.141593, 3.926991, 4.712389, 5.497787, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.000000, 0.785398, 1.570796, 2.356194, 3.141593, 3.926991, 4.712389, 5.497787, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.785398, 2.356194, 3.926991, 5.497787};
        float eu1[48] = { 0.411138, 0.411138, 0.411138, 0.411138, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.730455, 2.730455, 2.730455, 2.730455};
        float eu2[48] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,48);
        return rslt;
    }

    static M33f*HealPix3(uint32&N) {
        /// Estimated angular resolution: 19.544100476116796
        N = 108;
        M33f*rslt = new M33f[108];
        float eu0[108] = { 0.785398, 2.356194, 3.926991, 5.497787, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.000000, 0.523599, 1.047198, 1.570796, 2.094395, 2.617994, 3.141593, 3.665191, 4.188790, 4.712389, 5.235988, 5.759587, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.000000, 0.523599, 1.047198, 1.570796, 2.094395, 2.617994, 3.141593, 3.665191, 4.188790, 4.712389, 5.235988, 5.759587, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.000000, 0.523599, 1.047198, 1.570796, 2.094395, 2.617994, 3.141593, 3.665191, 4.188790, 4.712389, 5.235988, 5.759587, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.785398, 2.356194, 3.926991, 5.497787};
        float eu1[108] = { 0.273013, 0.273013, 0.273013, 0.273013, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.868580, 2.868580, 2.868580, 2.868580};
        float eu2[108] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,108);
        return rslt;
    }

    static M33f*HealPix4(uint32&N) {
        /// Estimated angular resolution: 14.658075357087599
        N = 192;
        M33f*rslt = new M33f[192];
        float eu0[192] = { 0.785398, 2.356194, 3.926991, 5.497787, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.000000, 0.392699, 0.785398, 1.178097, 1.570796, 1.963495, 2.356194, 2.748894, 3.141593, 3.534292, 3.926991, 4.319690, 4.712389, 5.105088, 5.497787, 5.890486, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.000000, 0.392699, 0.785398, 1.178097, 1.570796, 1.963495, 2.356194, 2.748894, 3.141593, 3.534292, 3.926991, 4.319690, 4.712389, 5.105088, 5.497787, 5.890486, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.000000, 0.392699, 0.785398, 1.178097, 1.570796, 1.963495, 2.356194, 2.748894, 3.141593, 3.534292, 3.926991, 4.319690, 4.712389, 5.105088, 5.497787, 5.890486, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.000000, 0.392699, 0.785398, 1.178097, 1.570796, 1.963495, 2.356194, 2.748894, 3.141593, 3.534292, 3.926991, 4.319690, 4.712389, 5.105088, 5.497787, 5.890486, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.785398, 2.356194, 3.926991, 5.497787};
        float eu1[192] = { 0.204480, 0.204480, 0.204480, 0.204480, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.622368, 0.622368, 0.622368, 0.622368, 0.622368, 0.622368, 0.622368, 0.622368, 0.622368, 0.622368, 0.622368, 0.622368, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.047198, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.403348, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.738244, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.094395, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.519224, 2.519224, 2.519224, 2.519224, 2.519224, 2.519224, 2.519224, 2.519224, 2.519224, 2.519224, 2.519224, 2.519224, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.937112, 2.937112, 2.937112, 2.937112};
        float eu2[192] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,192);
        return rslt;
    }

    static M33f*HealPix5(uint32&N) {
        /// Estimated angular resolution: 11.726460285670079
        N = 300;
        M33f*rslt = new M33f[300];
        float eu0[300] = { 0.785398, 2.356194, 3.926991, 5.497787, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.157080, 0.471239, 0.785398, 1.099557, 1.413717, 1.727876, 2.042035, 2.356194, 2.670354, 2.984513, 3.298672, 3.612832, 3.926991, 4.241150, 4.555309, 4.869469, 5.183628, 5.497787, 5.811946, 6.126106, 0.000000, 0.314159, 0.628319, 0.942478, 1.256637, 1.570796, 1.884956, 2.199115, 2.513274, 2.827433, 3.141593, 3.455752, 3.769911, 4.084070, 4.398230, 4.712389, 5.026548, 5.340708, 5.654867, 5.969026, 0.157080, 0.471239, 0.785398, 1.099557, 1.413717, 1.727876, 2.042035, 2.356194, 2.670354, 2.984513, 3.298672, 3.612832, 3.926991, 4.241150, 4.555309, 4.869469, 5.183628, 5.497787, 5.811946, 6.126106, 0.000000, 0.314159, 0.628319, 0.942478, 1.256637, 1.570796, 1.884956, 2.199115, 2.513274, 2.827433, 3.141593, 3.455752, 3.769911, 4.084070, 4.398230, 4.712389, 5.026548, 5.340708, 5.654867, 5.969026, 0.157080, 0.471239, 0.785398, 1.099557, 1.413717, 1.727876, 2.042035, 2.356194, 2.670354, 2.984513, 3.298672, 3.612832, 3.926991, 4.241150, 4.555309, 4.869469, 5.183628, 5.497787, 5.811946, 6.126106, 0.000000, 0.314159, 0.628319, 0.942478, 1.256637, 1.570796, 1.884956, 2.199115, 2.513274, 2.827433, 3.141593, 3.455752, 3.769911, 4.084070, 4.398230, 4.712389, 5.026548, 5.340708, 5.654867, 5.969026, 0.157080, 0.471239, 0.785398, 1.099557, 1.413717, 1.727876, 2.042035, 2.356194, 2.670354, 2.984513, 3.298672, 3.612832, 3.926991, 4.241150, 4.555309, 4.869469, 5.183628, 5.497787, 5.811946, 6.126106, 0.000000, 0.314159, 0.628319, 0.942478, 1.256637, 1.570796, 1.884956, 2.199115, 2.513274, 2.827433, 3.141593, 3.455752, 3.769911, 4.084070, 4.398230, 4.712389, 5.026548, 5.340708, 5.654867, 5.969026, 0.157080, 0.471239, 0.785398, 1.099557, 1.413717, 1.727876, 2.042035, 2.356194, 2.670354, 2.984513, 3.298672, 3.612832, 3.926991, 4.241150, 4.555309, 4.869469, 5.183628, 5.497787, 5.811946, 6.126106, 0.000000, 0.314159, 0.628319, 0.942478, 1.256637, 1.570796, 1.884956, 2.199115, 2.513274, 2.827433, 3.141593, 3.455752, 3.769911, 4.084070, 4.398230, 4.712389, 5.026548, 5.340708, 5.654867, 5.969026, 0.157080, 0.471239, 0.785398, 1.099557, 1.413717, 1.727876, 2.042035, 2.356194, 2.670354, 2.984513, 3.298672, 3.612832, 3.926991, 4.241150, 4.555309, 4.869469, 5.183628, 5.497787, 5.811946, 6.126106, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.785398, 2.356194, 3.926991, 5.497787};
        float eu1[300] = { 0.163481, 0.163481, 0.163481, 0.163481, 0.328068, 0.328068, 0.328068, 0.328068, 0.328068, 0.328068, 0.328068, 0.328068, 0.494934, 0.494934, 0.494934, 0.494934, 0.494934, 0.494934, 0.494934, 0.494934, 0.494934, 0.494934, 0.494934, 0.494934, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.665405, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.008260, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.159279, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.300864, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.437065, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.704528, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.840729, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 1.982313, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.133333, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.476187, 2.646659, 2.646659, 2.646659, 2.646659, 2.646659, 2.646659, 2.646659, 2.646659, 2.646659, 2.646659, 2.646659, 2.646659, 2.813525, 2.813525, 2.813525, 2.813525, 2.813525, 2.813525, 2.813525, 2.813525, 2.978111, 2.978111, 2.978111, 2.978111};
        float eu2[300] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,300);
        return rslt;
    }

    static M33f*HealPix6(uint32&N) {
        /// Estimated angular resolution: 9.772050238058398
        N = 432;
        M33f*rslt = new M33f[432];
        float eu0[432] = { 0.785398, 2.356194, 3.926991, 5.497787, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.157080, 0.471239, 0.785398, 1.099557, 1.413717, 1.727876, 2.042035, 2.356194, 2.670354, 2.984513, 3.298672, 3.612832, 3.926991, 4.241150, 4.555309, 4.869469, 5.183628, 5.497787, 5.811946, 6.126106, 0.130900, 0.392699, 0.654498, 0.916298, 1.178097, 1.439897, 1.701696, 1.963495, 2.225295, 2.487094, 2.748894, 3.010693, 3.272492, 3.534292, 3.796091, 4.057891, 4.319690, 4.581489, 4.843289, 5.105088, 5.366887, 5.628687, 5.890486, 6.152286, 0.000000, 0.261799, 0.523599, 0.785398, 1.047198, 1.308997, 1.570796, 1.832596, 2.094395, 2.356194, 2.617994, 2.879793, 3.141593, 3.403392, 3.665191, 3.926991, 4.188790, 4.450590, 4.712389, 4.974188, 5.235988, 5.497787, 5.759587, 6.021386, 0.130900, 0.392699, 0.654498, 0.916298, 1.178097, 1.439897, 1.701696, 1.963495, 2.225295, 2.487094, 2.748894, 3.010693, 3.272492, 3.534292, 3.796091, 4.057891, 4.319690, 4.581489, 4.843289, 5.105088, 5.366887, 5.628687, 5.890486, 6.152286, 0.000000, 0.261799, 0.523599, 0.785398, 1.047198, 1.308997, 1.570796, 1.832596, 2.094395, 2.356194, 2.617994, 2.879793, 3.141593, 3.403392, 3.665191, 3.926991, 4.188790, 4.450590, 4.712389, 4.974188, 5.235988, 5.497787, 5.759587, 6.021386, 0.130900, 0.392699, 0.654498, 0.916298, 1.178097, 1.439897, 1.701696, 1.963495, 2.225295, 2.487094, 2.748894, 3.010693, 3.272492, 3.534292, 3.796091, 4.057891, 4.319690, 4.581489, 4.843289, 5.105088, 5.366887, 5.628687, 5.890486, 6.152286, 0.000000, 0.261799, 0.523599, 0.785398, 1.047198, 1.308997, 1.570796, 1.832596, 2.094395, 2.356194, 2.617994, 2.879793, 3.141593, 3.403392, 3.665191, 3.926991, 4.188790, 4.450590, 4.712389, 4.974188, 5.235988, 5.497787, 5.759587, 6.021386, 0.130900, 0.392699, 0.654498, 0.916298, 1.178097, 1.439897, 1.701696, 1.963495, 2.225295, 2.487094, 2.748894, 3.010693, 3.272492, 3.534292, 3.796091, 4.057891, 4.319690, 4.581489, 4.843289, 5.105088, 5.366887, 5.628687, 5.890486, 6.152286, 0.000000, 0.261799, 0.523599, 0.785398, 1.047198, 1.308997, 1.570796, 1.832596, 2.094395, 2.356194, 2.617994, 2.879793, 3.141593, 3.403392, 3.665191, 3.926991, 4.188790, 4.450590, 4.712389, 4.974188, 5.235988, 5.497787, 5.759587, 6.021386, 0.130900, 0.392699, 0.654498, 0.916298, 1.178097, 1.439897, 1.701696, 1.963495, 2.225295, 2.487094, 2.748894, 3.010693, 3.272492, 3.534292, 3.796091, 4.057891, 4.319690, 4.581489, 4.843289, 5.105088, 5.366887, 5.628687, 5.890486, 6.152286, 0.000000, 0.261799, 0.523599, 0.785398, 1.047198, 1.308997, 1.570796, 1.832596, 2.094395, 2.356194, 2.617994, 2.879793, 3.141593, 3.403392, 3.665191, 3.926991, 4.188790, 4.450590, 4.712389, 4.974188, 5.235988, 5.497787, 5.759587, 6.021386, 0.130900, 0.392699, 0.654498, 0.916298, 1.178097, 1.439897, 1.701696, 1.963495, 2.225295, 2.487094, 2.748894, 3.010693, 3.272492, 3.534292, 3.796091, 4.057891, 4.319690, 4.581489, 4.843289, 5.105088, 5.366887, 5.628687, 5.890486, 6.152286, 0.000000, 0.261799, 0.523599, 0.785398, 1.047198, 1.308997, 1.570796, 1.832596, 2.094395, 2.356194, 2.617994, 2.879793, 3.141593, 3.403392, 3.665191, 3.926991, 4.188790, 4.450590, 4.712389, 4.974188, 5.235988, 5.497787, 5.759587, 6.021386, 0.130900, 0.392699, 0.654498, 0.916298, 1.178097, 1.439897, 1.701696, 1.963495, 2.225295, 2.487094, 2.748894, 3.010693, 3.272492, 3.534292, 3.796091, 4.057891, 4.319690, 4.581489, 4.843289, 5.105088, 5.366887, 5.628687, 5.890486, 6.152286, 0.157080, 0.471239, 0.785398, 1.099557, 1.413717, 1.727876, 2.042035, 2.356194, 2.670354, 2.984513, 3.298672, 3.612832, 3.926991, 4.241150, 4.555309, 4.869469, 5.183628, 5.497787, 5.811946, 6.126106, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.785398, 2.356194, 3.926991, 5.497787};
        float eu1[432] = { 0.136188, 0.136188, 0.136188, 0.136188, 0.273013, 0.273013, 0.273013, 0.273013, 0.273013, 0.273013, 0.273013, 0.273013, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.411138, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.551286, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.694274, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 0.981765, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.110242, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.230959, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.346703, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.459455, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.682137, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.794889, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 1.910633, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.031350, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.159827, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.447319, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.590307, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.730455, 2.868580, 2.868580, 2.868580, 2.868580, 2.868580, 2.868580, 2.868580, 2.868580, 3.005405, 3.005405, 3.005405, 3.005405};
        float eu2[432] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,432);
        return rslt;
    }

    static M33f*HealPix7(uint32&N) {
        /// Estimated angular resolution: 8.376043061192913
        N = 588;
        M33f*rslt = new M33f[588];
        float eu0[588] = { 0.785398, 2.356194, 3.926991, 5.497787, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.157080, 0.471239, 0.785398, 1.099557, 1.413717, 1.727876, 2.042035, 2.356194, 2.670354, 2.984513, 3.298672, 3.612832, 3.926991, 4.241150, 4.555309, 4.869469, 5.183628, 5.497787, 5.811946, 6.126106, 0.130900, 0.392699, 0.654498, 0.916298, 1.178097, 1.439897, 1.701696, 1.963495, 2.225295, 2.487094, 2.748894, 3.010693, 3.272492, 3.534292, 3.796091, 4.057891, 4.319690, 4.581489, 4.843289, 5.105088, 5.366887, 5.628687, 5.890486, 6.152286, 0.112200, 0.336599, 0.560999, 0.785398, 1.009798, 1.234197, 1.458597, 1.682996, 1.907396, 2.131795, 2.356194, 2.580594, 2.804993, 3.029393, 3.253792, 3.478192, 3.702591, 3.926991, 4.151390, 4.375790, 4.600189, 4.824589, 5.048988, 5.273388, 5.497787, 5.722187, 5.946586, 6.170986, 0.000000, 0.224399, 0.448799, 0.673198, 0.897598, 1.121997, 1.346397, 1.570796, 1.795196, 2.019595, 2.243995, 2.468394, 2.692794, 2.917193, 3.141593, 3.365992, 3.590392, 3.814791, 4.039191, 4.263590, 4.487990, 4.712389, 4.936788, 5.161188, 5.385587, 5.609987, 5.834386, 6.058786, 0.112200, 0.336599, 0.560999, 0.785398, 1.009798, 1.234197, 1.458597, 1.682996, 1.907396, 2.131795, 2.356194, 2.580594, 2.804993, 3.029393, 3.253792, 3.478192, 3.702591, 3.926991, 4.151390, 4.375790, 4.600189, 4.824589, 5.048988, 5.273388, 5.497787, 5.722187, 5.946586, 6.170986, 0.000000, 0.224399, 0.448799, 0.673198, 0.897598, 1.121997, 1.346397, 1.570796, 1.795196, 2.019595, 2.243995, 2.468394, 2.692794, 2.917193, 3.141593, 3.365992, 3.590392, 3.814791, 4.039191, 4.263590, 4.487990, 4.712389, 4.936788, 5.161188, 5.385587, 5.609987, 5.834386, 6.058786, 0.112200, 0.336599, 0.560999, 0.785398, 1.009798, 1.234197, 1.458597, 1.682996, 1.907396, 2.131795, 2.356194, 2.580594, 2.804993, 3.029393, 3.253792, 3.478192, 3.702591, 3.926991, 4.151390, 4.375790, 4.600189, 4.824589, 5.048988, 5.273388, 5.497787, 5.722187, 5.946586, 6.170986, 0.000000, 0.224399, 0.448799, 0.673198, 0.897598, 1.121997, 1.346397, 1.570796, 1.795196, 2.019595, 2.243995, 2.468394, 2.692794, 2.917193, 3.141593, 3.365992, 3.590392, 3.814791, 4.039191, 4.263590, 4.487990, 4.712389, 4.936788, 5.161188, 5.385587, 5.609987, 5.834386, 6.058786, 0.112200, 0.336599, 0.560999, 0.785398, 1.009798, 1.234197, 1.458597, 1.682996, 1.907396, 2.131795, 2.356194, 2.580594, 2.804993, 3.029393, 3.253792, 3.478192, 3.702591, 3.926991, 4.151390, 4.375790, 4.600189, 4.824589, 5.048988, 5.273388, 5.497787, 5.722187, 5.946586, 6.170986, 0.000000, 0.224399, 0.448799, 0.673198, 0.897598, 1.121997, 1.346397, 1.570796, 1.795196, 2.019595, 2.243995, 2.468394, 2.692794, 2.917193, 3.141593, 3.365992, 3.590392, 3.814791, 4.039191, 4.263590, 4.487990, 4.712389, 4.936788, 5.161188, 5.385587, 5.609987, 5.834386, 6.058786, 0.112200, 0.336599, 0.560999, 0.785398, 1.009798, 1.234197, 1.458597, 1.682996, 1.907396, 2.131795, 2.356194, 2.580594, 2.804993, 3.029393, 3.253792, 3.478192, 3.702591, 3.926991, 4.151390, 4.375790, 4.600189, 4.824589, 5.048988, 5.273388, 5.497787, 5.722187, 5.946586, 6.170986, 0.000000, 0.224399, 0.448799, 0.673198, 0.897598, 1.121997, 1.346397, 1.570796, 1.795196, 2.019595, 2.243995, 2.468394, 2.692794, 2.917193, 3.141593, 3.365992, 3.590392, 3.814791, 4.039191, 4.263590, 4.487990, 4.712389, 4.936788, 5.161188, 5.385587, 5.609987, 5.834386, 6.058786, 0.112200, 0.336599, 0.560999, 0.785398, 1.009798, 1.234197, 1.458597, 1.682996, 1.907396, 2.131795, 2.356194, 2.580594, 2.804993, 3.029393, 3.253792, 3.478192, 3.702591, 3.926991, 4.151390, 4.375790, 4.600189, 4.824589, 5.048988, 5.273388, 5.497787, 5.722187, 5.946586, 6.170986, 0.000000, 0.224399, 0.448799, 0.673198, 0.897598, 1.121997, 1.346397, 1.570796, 1.795196, 2.019595, 2.243995, 2.468394, 2.692794, 2.917193, 3.141593, 3.365992, 3.590392, 3.814791, 4.039191, 4.263590, 4.487990, 4.712389, 4.936788, 5.161188, 5.385587, 5.609987, 5.834386, 6.058786, 0.112200, 0.336599, 0.560999, 0.785398, 1.009798, 1.234197, 1.458597, 1.682996, 1.907396, 2.131795, 2.356194, 2.580594, 2.804993, 3.029393, 3.253792, 3.478192, 3.702591, 3.926991, 4.151390, 4.375790, 4.600189, 4.824589, 5.048988, 5.273388, 5.497787, 5.722187, 5.946586, 6.170986, 0.000000, 0.224399, 0.448799, 0.673198, 0.897598, 1.121997, 1.346397, 1.570796, 1.795196, 2.019595, 2.243995, 2.468394, 2.692794, 2.917193, 3.141593, 3.365992, 3.590392, 3.814791, 4.039191, 4.263590, 4.487990, 4.712389, 4.936788, 5.161188, 5.385587, 5.609987, 5.834386, 6.058786, 0.112200, 0.336599, 0.560999, 0.785398, 1.009798, 1.234197, 1.458597, 1.682996, 1.907396, 2.131795, 2.356194, 2.580594, 2.804993, 3.029393, 3.253792, 3.478192, 3.702591, 3.926991, 4.151390, 4.375790, 4.600189, 4.824589, 5.048988, 5.273388, 5.497787, 5.722187, 5.946586, 6.170986, 0.130900, 0.392699, 0.654498, 0.916298, 1.178097, 1.439897, 1.701696, 1.963495, 2.225295, 2.487094, 2.748894, 3.010693, 3.272492, 3.534292, 3.796091, 4.057891, 4.319690, 4.581489, 4.843289, 5.105088, 5.366887, 5.628687, 5.890486, 6.152286, 0.157080, 0.471239, 0.785398, 1.099557, 1.413717, 1.727876, 2.042035, 2.356194, 2.670354, 2.984513, 3.298672, 3.612832, 3.926991, 4.241150, 4.555309, 4.869469, 5.183628, 5.497787, 5.811946, 6.126106, 0.196350, 0.589049, 0.981748, 1.374447, 1.767146, 2.159845, 2.552544, 2.945243, 3.337942, 3.730641, 4.123340, 4.516039, 4.908739, 5.301438, 5.694137, 6.086836, 0.261799, 0.785398, 1.308997, 1.832596, 2.356194, 2.879793, 3.403392, 3.926991, 4.450590, 4.974188, 5.497787, 6.021386, 0.392699, 1.178097, 1.963495, 2.748894, 3.534292, 4.319690, 5.105088, 5.890486, 0.785398, 2.356194, 3.926991, 5.497787};
        float eu1[588] = { 0.116709, 0.116709, 0.116709, 0.116709, 0.233817, 0.233817, 0.233817, 0.233817, 0.233817, 0.233817, 0.233817, 0.233817, 0.351738, 0.351738, 0.351738, 0.351738, 0.351738, 0.351738, 0.351738, 0.351738, 0.351738, 0.351738, 0.351738, 0.351738, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.470909, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.591811, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.714987, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.841069, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 0.962551, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.074479, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.179970, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.281045, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.379149, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.475414, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.666179, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.762444, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.860548, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 1.961622, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.067114, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.179042, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.300524, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.426606, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.549782, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.670684, 2.789855, 2.789855, 2.789855, 2.789855, 2.789855, 2.789855, 2.789855, 2.789855, 2.789855, 2.789855, 2.789855, 2.789855, 2.907776, 2.907776, 2.907776, 2.907776, 2.907776, 2.907776, 2.907776, 2.907776, 3.024884, 3.024884, 3.024884, 3.024884};
        float eu2[588] = { 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};
        populate_rotation_array(rslt,eu0,eu1,eu2,588);

        return rslt;
    }

    static M33f*HealPix(uint32&N) {
        if( N == 1 ){
            return HealPix1(N);
        }
        else if( N == 2 ){
            return HealPix2(N);
        }
        else if( N == 3 ){
            return HealPix3(N);
        }
        else if( N == 4 ){
            return HealPix4(N);
        }
        else if( N == 5 ){
            return HealPix5(N);
        }
        else if( N == 6 ){
            return HealPix6(N);
        }
        else if( N == 7 ){
            return HealPix7(N);
        }
        else
            return NULL;
    }

    static M33f*cuboctahedral() {
        M33f*rslt = new M33f[24];
        V3f eu;
        M33f tmp;
        eu(0) = 0;
        eu(1) = 0;
        eu(2) = 0;
        for(int n=0;n<4;n++) {
            float angle = 2*M_PI*float(n)/float(4);
            eu(0) = angle;
            Math::eZYZ_Rmat(rslt[n],eu);
        }

        eu(0) = 0;
        eu(1) = M_PI/2;
        eu(2) = 0;
        Math::eZYZ_Rmat(tmp,eu);
        for(int n=0;n<4;n++) {
            rslt[n+ 4] = tmp*rslt[n];
        }

        eu(0) = 0;
        eu(1) = -M_PI/2;
        eu(2) = 0;
        Math::eZYZ_Rmat(tmp,eu);
        for(int n=0;n<4;n++) {
            rslt[n+ 8] = tmp*rslt[n];
        }

        eu(0) = 0;
        eu(1) = M_PI/2;
        eu(2) = 0;
        Math::eZXZ_Rmat(tmp,eu);
        for(int n=0;n<4;n++) {
            rslt[n+12] = tmp*rslt[n];
        }

        eu(0) = 0;
        eu(1) = -M_PI/2;
        eu(2) = 0;
        Math::eZXZ_Rmat(tmp,eu);
        for(int n=0;n<4;n++) {
            rslt[n+16] = tmp*rslt[n];
        }

        eu(0) = 0;
        eu(1) = M_PI;
        eu(2) = 0;
        Math::eZYZ_Rmat(tmp,eu);
        for(int n=0;n<4;n++) {
            rslt[n+20] = tmp*rslt[n];
        }

        return rslt;
    }

    static M33f*icosahedral() {
        M33f*rslt = new M33f[60];
        float eu0[60] = {-3.141593,-0.000000, 3.141593, 0.000000,-3.141593,-1.570796,-1.570796, 0.000000, 1.570796, 0.000000,-3.141593, 1.570796, 0.553574,-2.588018,-0.553574, 2.588018,-0.553574, 2.588018,-2.588018, 0.553574,-1.205932, 1.205932,-1.935660, 1.935660,-0.553574, 2.588018, 1.205932,-1.935660,-2.588018, 0.553574,-1.205932, 1.935660,-0.553574, 0.553574,-2.588018, 2.588018, 0.553574,-2.588018,-1.205932, 1.935660,-0.553574, 2.588018,-1.935660, 1.205932,-0.553574, 0.553574,-2.588018, 2.588018, 1.205932, 1.935660,-1.205932,-1.935660, 0.553574, 2.588018,-0.553574,-2.588018, 0.553574, 2.588018,-0.553574,-2.588018};
        float eu1[60] = { 3.141593, 3.141593, 0.000000, 0.000000, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.570796, 1.256637, 1.256637, 2.513274, 2.513274, 1.256637, 1.256637, 2.513274, 2.513274, 1.047198, 1.047198, 1.047198, 1.047198, 1.256637, 1.256637, 2.094395, 2.094395, 1.256637, 1.256637, 2.094395, 2.094395, 0.628319, 0.628319, 0.628319, 0.628319, 2.513274, 2.513274, 2.094395, 2.094395, 2.513274, 2.513274, 2.094395, 2.094395, 1.884956, 1.884956, 1.884956, 1.884956, 1.047198, 1.047198, 1.047198, 1.047198, 0.628319, 0.628319, 0.628319, 0.628319, 1.884956, 1.884956, 1.884956, 1.884956};
        float eu2[60] = { 0.000000, 0.000000, 0.000000, 0.000000, 1.570796, 3.141593, 0.000000, 1.570796, 0.000000,-1.570796,-1.570796, 3.141593, 2.588018,-0.553574, 0.553574,-2.588018,-2.588018, 0.553574, 2.588018,-0.553574, 1.935660,-1.935660, 1.205932,-1.205932, 0.553574,-2.588018, 1.935660,-1.205932, 2.588018,-0.553574,-1.935660, 1.205932, 2.588018,-2.588018, 0.553574,-0.553574, 2.588018,-0.553574, 1.205932,-1.935660,-2.588018, 0.553574, 1.935660,-1.205932, 2.588018,-2.588018, 0.553574,-0.553574, 1.205932, 1.935660,-1.205932,-1.935660, 0.553574, 2.588018,-0.553574,-2.588018, 0.553574, 2.588018,-0.553574,-2.588018};
        populate_rotation_array(rslt,eu0,eu1,eu2,60);
        return rslt;
    }
};

#endif /// ANGLES_SYMMETRY_H



